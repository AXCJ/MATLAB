clear all; clc
syms x1 x2 d3 real
T01=[cos(x1) 0 -sin(x1) 0;sin(x1) 0 cos(x1) 0;0 -1 0 0;0 0 0 1];
T12=[cos(x2) 0 sin(x2) 0;sin(x2) 0 -cos(x2) 0;0 1 0 2.5;0 0 0 1];
T23=[1 0 0 0;0 1 0 0; 0 0 1 d3; 0 0 0 1];

T02 = T01*T12;
T03 = T02*T23;
T13 = T12*T23;
P01 = T01(1:3, :)*[0 0 0 1]';
P02 = T02(1:3, :)*[0 0 0 1]';
P03 = T03(1:3, :)*[0 0 0 1]';
P13 = T13(1:3, :)*[0 0 0 1]';
% P03-P02
% T02(1:3,1:3)*T23(1:3,4)

Z00 = [0 0 1]';
Z01 = T01(1:3, 3);
Z02 = T02(1:3, 3);

J0E= simplify([Z00 Z01 [0 0 0]'; cross(Z00,P03) cross(Z01, P03-P01) Z02])

R30 = T03(1:3,1:3)'
JEE = simplify(blkdiag(R30,R30)*J0E)